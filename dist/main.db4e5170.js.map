{"version":3,"sources":["main.js"],"names":["canvas","document","getElementById","ctx","getContext","brush","eraser","reSetCanvas","save","revocation","back_revocation","penDetail","closeBtn","getElementsByClassName","range1","thickness","ColorPen","iseEraser","isPenDetail","lWidth","radius","autoSetSize","monitorToUser","changePenColor","setCanvasBg","canvasSetSize","pageWidth","documentElement","clientWidth","pageHeight","clientHeight","width","height","window","onresize","draw","lastPlace","isTouchDevice","ontouchstart","e","x","touches","clientX","y","clientY","clearCircle","drawCircle","ontouchmove","moveHandler","newPlace","drawLine","ontouchend","record_operation","onmousedown","onmousemove","onmouseup","beginPath","arc","Math","PI","fill","closePath","x1","y1","x2","y2","lineWidth","lineCap","lineJoin","moveTo","lineTo","stroke","clip","clearRect","restore","asin","sin","atan","acos","cos","x3","y3","x4","y4","x5","y5","x6","y6","onclick","classList","add","remove","onchange","style","transform","parseInt","value","i","length","j","activeColor","backgroundColor","fillStyle","strokeStyle","canvasHistory","color","fillRect","imgUrl","toDataURL","saveA","createElement","body","appendChild","href","download","Date","getTime","target","click","step","push","canvasRevocation","canvasPic","Image","src","onload","drawImage","alert","canvas_back_revocation","console","log","btnParent","parentElement"],"mappings":"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","file":"main.db4e5170.js","sourceRoot":"..\\src","sourcesContent":["let canvas = document.getElementById(\"canvas\");\r\nlet ctx = canvas.getContext(\"2d\");\r\nlet brush = document.getElementById('brush');\r\nlet eraser = document.getElementById(\"eraser\");\r\nlet reSetCanvas = document.getElementById(\"clear\");\r\nlet save = document.getElementById(\"save\");\r\nlet revocation = document.getElementById(\"revocation\");\r\nlet back_revocation = document.getElementById(\"back_revocation\");\r\n\r\nlet penDetail = document.getElementById(\"penDetail\");\r\nlet closeBtn = document.getElementsByClassName('closeBtn');\r\nlet range1 = document.getElementById('range1');\r\nlet thickness = document.getElementById(\"thickness\");\r\nlet ColorPen = document.getElementsByClassName(\"color-item\");\r\n//初始化橡皮擦\r\nlet iseEraser = false;\r\n//初始化画笔\r\nlet isPenDetail = false;\r\n//初始画笔粗细\r\nlet lWidth = 4;\r\nlet radius =2;\r\n\r\nautoSetSize();\r\nmonitorToUser();\r\nchangePenColor();\r\nsetCanvasBg('white');\r\n\r\n//获取文本大小函数\r\nfunction autoSetSize(){\r\n  canvasSetSize();\r\n    function canvasSetSize(){\r\n      // 把变化之前的画布内容copy一份，\r\n      // let imgData = ctx.getImageData(0,0,canvas.width,canvas.height);\r\n      //然后重新画到画布上,\r\n\r\n\r\n      let pageWidth = document.documentElement.clientWidth;\r\n      let pageHeight = document.documentElement.clientHeight;\r\n      canvas.width = pageWidth;\r\n      canvas.height = pageHeight;\r\n\r\n      // ctx.putImageData(imgData,0,0);\r\n  }\r\n\r\n  window.onresize = function(){\r\n      canvasSetSize();\r\n  }\r\n}\r\n\r\n//监听鼠标 手机触屏事件 函数\r\nfunction monitorToUser() { \r\n    //初始化画板状态\r\n  let draw =false;\r\n    //最后画的位置\r\n  let lastPlace;\r\n    //适配手机触摸\r\n  let isTouchDevice = \"ontouchstart\" in document.documentElement;\r\n\r\n  if (isTouchDevice) {\r\n    //适配手机 手指放下\r\n    canvas.ontouchstart = (e) => {\r\n        draw = true;\r\n        let x = e.touches[0].clientX;\r\n        let y = e.touches[0].clientY;\r\n        if (iseEraser) {//要使用eraser\r\n          clearCircle(x, y, radius)\r\n          lastPlace =[x,y];\r\n        }else{\r\n          drawCircle(x,y,radius);\r\n          lastPlace =[x, y];\r\n        }\r\n    };\r\n   //手指移动\r\n    canvas.ontouchmove = (e) => {\r\n        let x = e.touches[0].clientX;\r\n        let y = e.touches[0].clientY;\r\n        if (!draw) { return }\r\n        if (iseEraser) {\r\n          moveHandler(lastPlace[0],lastPlace[1],x,y);\r\n          lastPlace = [x,y];\r\n        } else {\r\n          let newPlace = [x, y];\r\n          drawLine(lastPlace[0], lastPlace[1], x, y);\r\n          lastPlace =newPlace;//这次作为上次的位置\r\n        }\r\n    }\r\n    //手指离开\r\n    canvas.ontouchend = (e) => {\r\n      draw = false;\r\n      record_operation();\r\n    }\r\n\r\n  }else{\r\n\r\n    //PC\r\n    //鼠标放下为ture\r\n    canvas.onmousedown = (e) => {\r\n        let x = e.clientX;\r\n        let y = e.clientY;\r\n        draw = true;\r\n        if (iseEraser) {//要使用eraser\r\n        // ctx.clearRect(x - lWidth/2, y - lWidth/2, lWidth, lWidth);\r\n          clearCircle(x, y, radius)\r\n          lastPlace =[x,y];\r\n        }else{\r\n          drawCircle(x,y,radius);\r\n          lastPlace =[x, y];\r\n        }\r\n    }\r\n    canvas.onmousemove = (e) => {\r\n          let x = e.clientX;\r\n          let y = e.clientY;\r\n          if (!draw) { return }\r\n          if (iseEraser) {\r\n          //  ctx.clearRect(x - lWidth/2, y - lWidth/2, lWidth, lWidth);\r\n            moveHandler(lastPlace[0],lastPlace[1],x,y);\r\n            lastPlace = [x,y];\r\n          } else {\r\n            let newPlace = [x, y];\r\n            drawLine(lastPlace[0], lastPlace[1], x, y);\r\n            lastPlace =newPlace;//这次作为上次的位置\r\n        }\r\n    }\r\n    //鼠标松开\r\n    canvas.onmouseup = (e) => {\r\n      draw = false;\r\n      record_operation();\r\n    }\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\n//画点函数\r\nfunction drawCircle(x,y,radius){\r\n    // 新建一条路径，生成之后，图形绘制命令被指向到路径上生成路径。\r\n    ctx.beginPath();\r\n    // 画一个以（x,y）为圆心的以radius为半径的圆弧（圆），\r\n    // 从startAngle开始到endAngle结束，按照anticlockwise给定的方向（默认为顺时针）来生成。\r\n    ctx.arc(x,y,lWidth/2,0,Math.PI*2);\r\n    // 通过填充路径的内容区域生成实心的图形\r\n    ctx.fill();\r\n    // 闭合路径之后图形绘制命令又重新指向到上下文中。\r\n    ctx.closePath();\r\n}\r\n\r\n\r\n//画线\r\nfunction drawLine(x1, y1, x2, y2) {\r\n  ctx.save()\r\n  ctx.lineWidth = lWidth;\r\n  ctx.lineCap = \"round\";\r\n  ctx.lineJoin = \"round\";\r\n  ctx.beginPath();\r\n  ctx.moveTo(x1, y1);\r\n  ctx.lineTo(x2, y2);\r\n  ctx.stroke();\r\n  ctx.closePath();\r\n  }\r\n\r\n//橡皮圆点\r\nfunction clearCircle(x, y, radius) {\r\n  ctx.save()\r\n  ctx.beginPath()\r\n  ctx.arc(x,y,lWidth/2,0,2*Math.PI);\r\n  ctx.clip()\r\n  ctx.clearRect(0,0,canvas.width,canvas.height);\r\n  ctx.restore();\r\n  ctx.closePath();\r\n}\r\nfunction moveHandler(x1,y1,x2,y2){\r\n  //获取两个点之间的剪辑区域四个端点\r\n  let asin = lWidth/2*Math.sin(Math.atan((y2-y1)/(x2-x1)));\r\n  let acos = lWidth/2*Math.cos(Math.atan((y2-y1)/(x2-x1)))\r\n  let x3 = x1+asin;\r\n  let y3 = y1-acos;\r\n  let x4 = x1-asin;\r\n  let y4 = y1+acos;\r\n  let x5 = x2+asin;\r\n  let y5 = y2-acos;\r\n  let x6 = x2-asin;\r\n  let y6 = y2+acos;\r\n\r\n  //保证线条的连贯，所以在矩形一端画圆\r\n  clearCircle(x2, y2, radius)\r\n\r\n  //清除矩形剪辑区域里的像素\r\n  ctx.save()\r\n  ctx.beginPath()\r\n  ctx.moveTo(x3,y3);\r\n  ctx.lineTo(x5,y5);\r\n  ctx.lineTo(x6,y6);\r\n  ctx.lineTo(x4,y4);\r\n  ctx.closePath();\r\n  ctx.clip();\r\n  ctx.clearRect(0,0,canvas.width,canvas.height);\r\n  ctx.restore();\r\n  ctx.closePath();\r\n}\r\n\r\n// 橡皮檫功能\r\neraser.onclick = function(){\r\n      iseEraser = true;\r\n      eraser.classList.add('active');\r\n      brush.classList.remove('active');\r\n}\r\n\r\n//改变画笔粗细\r\nrange1.onchange = function () { \r\n  // console.log(range1.value);\r\n  // console.log(typeof range1.value);\r\n  thickness.style.transform = 'scale('+(parseInt(range1.value))+')';\r\n  // console.log(thickness.style.transform);\r\n  lWidth = parseInt(range1.value*2);\r\n}\r\n\r\n\r\n//点击画笔\r\nbrush.onclick = function () { \r\n  iseEraser = false;\r\n  eraser.classList.remove('active');\r\n  brush.classList.add('active');\r\n  if (!isPenDetail) {\r\n    penDetail.classList.add('active');\r\n  } else { \r\n    penDetail.classList.remove('active');\r\n  }\r\n  isPenDetail = !isPenDetail;\r\n}\r\n\r\n//改变画笔颜色\r\nfunction changePenColor() { \r\n  for (var i = 0; i < ColorPen.length; i++) {\r\n    ColorPen[i].onclick = function () {\r\n      for (var j = 0; j < ColorPen.length;j++) {\r\n        ColorPen[j].classList.remove('active');\r\n        this.classList.add('active');\r\n        activeColor = this.style.backgroundColor;\r\n        ctx.fillStyle = activeColor;\r\n        ctx.strokeStyle = activeColor;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 实现清屏\r\nreSetCanvas.onclick = function(){\r\n  ctx.clearRect(0,0,canvas.width,canvas.height);\r\n  setCanvasBg('white');\r\n  canvasHistory=[];\r\n}\r\n\r\n// 重新设置canvas背景颜色\r\nfunction setCanvasBg(color) {\r\n  ctx.fillStyle = color;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n}\r\n\r\n// 下载图片\r\nsave.onclick = function(){\r\n  let imgUrl = canvas.toDataURL('image/png');\r\n  let saveA = document.createElement('a');\r\n  document.body.appendChild(saveA);\r\n  saveA.href = imgUrl;\r\n  saveA.download = 'mypic'+(new Date).getTime();\r\n  saveA.target = '_blank';\r\n  saveA.click();\r\n}\r\n\r\n// 实现撤销的功能\r\nlet canvasHistory = [];\r\nlet step = -1;\r\n\r\n//记录每一步画画的操作函数\r\nfunction record_operation(){\r\n  step++;\r\n  if(step < canvasHistory.length){//历史数组记录的步数\r\n    canvasHistory.length = step;\r\n  }\r\n\r\n  // 添加新的绘制记录到历史记录\r\n  canvasHistory.push(canvas.toDataURL());\r\n  if(step > -1){\r\n    revocation.classList.add('active');\r\n  }\r\n}\r\n\r\n//撤回方法\r\nfunction canvasRevocation(){\r\n  if(step > 0){\r\n    step--;\r\n    let canvasPic = new Image();\r\n    canvasPic.src = canvasHistory[step];\r\n\r\n    canvasPic.onload =  ()=> {\r\n      ctx.drawImage(canvasPic, 0, 0);\r\n    }\r\n    revocation.classList.add('active');\r\n    back_revocation.classList.add('active');\r\n  }else{\r\n    revocation.classList.remove('active');\r\n    alert('已经无法撤回');\r\n  }\r\n}\r\n//取消撤回方法\r\nfunction  canvas_back_revocation(){\r\n  if(step < canvasHistory.length - 1){\r\n      step++;\r\n      let canvasPic = new Image();\r\n      canvasPic.src = canvasHistory[step];\r\n      canvasPic.onload = function () {\r\n        ctx.drawImage(canvasPic, 0, 0);\r\n      }\r\n    }else {\r\n      back_revocation.classList.remove('active')\r\n      alert('已经是最新的记录了');\r\n    }\r\n}\r\n\r\nrevocation.onclick = ()=>{\r\n  canvasRevocation();\r\n}\r\nback_revocation.onclick=()=>{\r\n  canvas_back_revocation();\r\n}\r\n\r\n//close功能\r\n\r\nfor (let i = 0; i < closeBtn.length; i++) {\r\n  closeBtn[i].onclick = function (e) {\r\n    console.log(closeBtn[i]);\r\n    let btnParent = e.target.parentElement;\r\n    btnParent.classList.remove('active');\r\n  }\r\n}\r\n\r\n\r\n"]}